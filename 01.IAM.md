# IAM

## 概要

- AWSにおける権限を管理する（グローバルサービスでリージョンによらない）

## IAMコンポーネント

- ユーザー
  - AWSにアクセスするユーザーを作成可能
    - ユーザー個人に対してAWSコンポーネントの操作権限を付与することができるが、通常はグループを経由して権限を付与する
- グループ
  - グループに対して権限を付与することができ、グループに対して複数ユーザーを所属させることができる
    - グループに所属するユーザーは全員グループに対して付与された操作を行うことができる
- ポリシー
  - AWSによって作成済みの権限を確認可能
    - オリジナルのポリシーを作成することも可能
- ロール
  - AWSのコンポーネントに対して権限を付与できる
    - 基本的には作成したAWSコンポーネント（EC2、Lambda、CloudFormationなど）に対してRDSへの操作権限を付与する場合などに使用する

## ベストプラクティス

- rootユーザーは基本使わず、基本的には近い権限を持つ管理者アカウントを作成し、そのアカウントを使用する
  - rootユーザーは初期設定や解約時のみ使用すること
- 初期パスワードポリシーが弱めなので、できるだけ早めに変更する
  - パスワードの最小文字数をパスワード管理ソフトウェアで生成できる最大文字数にする
  - パスワードの強度全てにチェックする
  - パスワードの有効期限を90日にする
  - ユーザーにパスワードの変更を許可をオンにする
  - パスワードの再利用を禁止するをオン→5回にする
- Security Token Service (STS) は使用するリージョン以外は非アクティブにする
- それぞれのIAMユーザーはIAMのグループに割り当てる
  - グループに割り当てずにユーザーに対して権限を付与することも可能だが、基本的には非推奨
- グループ、ユーザーには最低限の権限のみ付与する
- １AWSユーザーにつき、１物理ユーザを割り当てる
  - 複数人で１AWSユーザーを共有しないこと
- MFAを設定すること
- ロールはAWSサービスに対して付与すること

## AWSへのアクセス方法

- Password + MFAcd
  - 直接入力によるアクセス
- AWS Cli
  - Access Keyによるアクセス
- AWS SDK（APIなど）
  - Access Keyによるアクセス

Access keyはAWSコンソールから作成する。（Access Keyは個人に紐づくため、他と共有しないこと）

## AWS Cliを用いたAWSへのアクセス

1. AWS Cliをインストール
2. IAMユーザーに対するアクセスキーを作成
3. 「aws configure」にてアクセスキーおよびシークレットキー、リージョンを設定

## 認証情報レポート

各ユーザーの情報をcsv形式でエクスポートできる
長期間アクセスしていないユーザーなどを確認できる

## アクセスアドバイザー

ユーザーが各AWSのコンポーネントに対して最後にいつアクセスしたかを確認することができる
不要な権限を削除するために使用する
